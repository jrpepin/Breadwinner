"CV_BIO_CHILD_HH_1999",
"YSAQ-326D_2000",
"YINC-1400_2000",
"YINC-1500_2000",
"YINC-1700_2000",
"YINC-1800_2000",
"YINC-2000_2000",
"YINC-2100_2000",
"YINC-2200_2000",
"YINC-2400_2000",
"YINC-2600_2000",
"CV_CHILD_BIRTH_DATE.01~M_2000",
"CV_CHILD_BIRTH_DATE.01~Y_2000",
"CV_INCOME_GROSS_YR_2000",
"CV_MARSTAT_2000",
"CV_BIO_CHILD_HH_2000",
"YSAQ-326D_2001",
"YINC-1400_2001",
"YINC-1500_2001",
"YINC-1700_2001",
"YINC-1800_2001",
"YINC-2000_2001",
"YINC-2100_2001",
"YINC-2200_2001",
"YINC-2400_2001",
"YINC-2600_2001",
"CV_CHILD_BIRTH_DATE.01~M_2001",
"CV_CHILD_BIRTH_DATE.01~Y_2001",
"CV_INCOME_GROSS_YR_2001",
"CV_MARSTAT_2001",
"CV_BIO_CHILD_HH_2001",
"YINC-1400_2002",
"YINC-1500_2002",
"YINC-1700_2002",
"YINC-1800_2002",
"YINC-2000_2002",
"YINC-2100_2002",
"YINC-2200_2002",
"YINC-2400_2002",
"YINC-2600_2002",
"YSAQ2-326D_2002",
"CV_CHILD_BIRTH_DATE.01~M_2002",
"CV_CHILD_BIRTH_DATE.01~Y_2002",
"CV_INCOME_GROSS_YR_2002",
"CV_MARSTAT_2002",
"CV_BIO_CHILD_HH_2002",
"CV_CHILD_BIRTH_DATE.01~M_2003",
"CV_CHILD_BIRTH_DATE.01~Y_2003",
"CV_INCOME_GROSS_YR_2003",
"CV_MARSTAT_2003",
"CV_BIO_CHILD_HH_2003",
"YINC-1400_2003",
"YINC-1700_2003",
"YINC-1800_2003",
"YINC-2000_2003",
"YINC-2100_2003",
"YINC-2200_2003",
"YINC-2400_2003",
"YINC-2600_2003",
"YSAQ2-326D_2003",
"CV_CHILD_BIRTH_DATE.01~M_2004",
"CV_CHILD_BIRTH_DATE.01~Y_2004",
"CV_INCOME_FAMILY_2004",
"CV_MARSTAT_2004",
"CV_BIO_CHILD_HH_2004",
"YINC-1400_2004",
"YINC-1700_2004",
"YINC-1800_2004",
"YINC-2000_2004",
"YINC-2100_2004",
"YINC-2200_2004",
"YINC-2400_2004",
"YINC-2600_2004",
"YSAQ2-326D_2004",
"CV_CHILD_BIRTH_DATE.01~M_2005",
"CV_CHILD_BIRTH_DATE.01~Y_2005",
"CV_INCOME_FAMILY_2005",
"CV_MARSTAT_2005",
"CV_BIO_CHILD_HH_2005",
"YINC-1400_2005",
"YINC-1700_2005",
"YINC-1800_2005",
"YINC-2000_2005",
"YINC-2100_2005",
"YINC-2200_2005",
"YINC-2400_2005",
"YINC-2600_2005",
"YSAQ2-326D_2005",
"CV_CHILD_BIRTH_DATE.01~M_2006",
"CV_CHILD_BIRTH_DATE.01~Y_2006",
"CV_INCOME_FAMILY_2006",
"CV_MARSTAT_2006",
"CV_BIO_CHILD_HH_2006",
"YINC-1400_2006",
"YINC-1700_2006",
"YINC-1800_2006",
"YINC-2000_2006",
"YINC-2100_2006",
"YINC-2200_2006",
"YINC-2400_2006",
"YINC-2600_2006",
"YSAQ2-326D_2006",
"CV_CHILD_BIRTH_DATE.01~M_2007",
"CV_CHILD_BIRTH_DATE.01~Y_2007",
"CV_INCOME_FAMILY_2007",
"CV_MARSTAT_2007",
"CV_BIO_CHILD_HH_2007",
"YINC-1400_2007",
"YINC-1700_2007",
"YINC-1800_2007",
"YINC-2000_2007",
"YINC-2100_2007",
"YINC-2200_2007",
"YINC-2400_2007",
"YINC-2600_2007",
"YSAQ2-326D_2007",
"CV_CHILD_BIRTH_DATE.01~M_2008",
"CV_CHILD_BIRTH_DATE.01~Y_2008",
"CV_INCOME_FAMILY_2008",
"CV_MARSTAT_2008",
"CV_BIO_CHILD_NR_2008",
"YINC-1400_2008",
"YINC-1700_2008",
"YINC-1800_2008",
"YINC-2000_2008",
"YINC-2100_2008",
"YINC-2200_2008",
"YINC-2400_2008",
"YINC-2600_2008",
"YSAQ2-326D_2008",
"CV_CHILD_BIRTH_DATE.01~M_2009",
"CV_CHILD_BIRTH_DATE.01~Y_2009",
"CV_INCOME_FAMILY_2009",
"CV_MARSTAT_2009",
"CV_BIO_CHILD_HH_2009",
"YINC-1400_2009",
"YINC-1700_2009",
"YINC-1800_2009",
"YINC-2000_2009",
"YINC-2100_2009",
"YINC-2200_2009",
"YINC-2400_2009",
"YINC-2600_2009",
"YSAQ2-326D_2009",
"CV_CHILD_BIRTH_DATE.01~M_2010",
"CV_CHILD_BIRTH_DATE.01~Y_2010",
"CV_INCOME_FAMILY_2010",
"CV_MARSTAT_2010",
"CV_BIO_CHILD_HH_2010",
"YINC-1400_2010",
"YINC-1700_2010",
"YINC-1800_2010",
"YINC-2000_2010",
"YINC-2100_2010",
"YINC-2200_2010",
"YINC-2400_2010",
"YINC-2600_2010",
"YSAQ2-326D_2010",
"CV_CHILD_BIRTH_DATE.01~M_2011",
"CV_CHILD_BIRTH_DATE.01~Y_2011",
"CV_INCOME_FAMILY_2011",
"CV_MARSTAT_2011",
"CV_BIO_CHILD_HH_2011",
"YINC-1400_2011",
"YINC-1700_2011",
"YINC-1800_2011",
"YINC-2000_2011",
"YINC-2100_2011",
"YINC-2200_2011",
"YINC-2400_2011",
"YINC-2600_2011",
"YSAQ2-326D_2011",
"CV_CHILD_BIRTH_DATE.01~M_2013",
"CV_CHILD_BIRTH_DATE.01~Y_2013",
"CV_INCOME_FAMILY_2013",
"CV_MARSTAT_2013",
"CV_BIO_CHILD_HH_2013",
"YINC-1400_2013",
"YINC-1700_2013",
"YINC-1800_2013",
"YINC-2000_2013",
"YINC-2100_2013",
"YINC-2200_2013",
"YINC-2400_2013",
"YINC-2600_2013",
"YSAQ2-326D_2013",
"CV_CHILD_BIRTH_DATE.01~M_2015",
"CV_CHILD_BIRTH_DATE.01~Y_2015",
"CV_INCOME_FAMILY_2015",
"CV_MARSTAT_2015",
"CV_BIO_CHILD_HH_2015",
"YINC-1400_2015",
"YINC-1700_2015",
"YINC-1800_2015",
"YINC-2000_2015",
"YINC-2100_2015",
"YINC-2200_2015",
"YINC-2400_2015",
"YINC-2600_2015",
"YSAQ2-326D_2015")
return(data)
}
#********************************************************************************************************
# Remove the '#' before the following line to create a data file called "categories" with value labels.
categories <- vallabels(new_data)
# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
new_data <- qnames(new_data)
categories <- qnames(categories)
# Produce summaries for the raw (uncategorized) data file
summary(new_data)
# Remove the '#' before the following lines to produce summaries for the "categories" data file.
#categories <- vallabels(new_data)
#summary(categories)
#************************************************************************************************************
# Change the working directory to the repository
setwd("C:/Users/Joanna/Dropbox/Repositories/NLSY97_Breadwinning")
# Use this script after the Investigator R script
# mark out the "Handle missing values" code in the Investigator script to analyze type of missing data
library(tidyverse)
library(lubridate)
## Fix caseID in categories dataset
categories$PUBID_1997 <- new_data$PUBID_1997
# Map special values to NA in every NUMERIC column: Refusal(-1), Don't Know(-2), Invalid Skip (-3),VALID SKIP(-4), NON-INTERVIEW(-5)
# library(naniar)
# na_special <- c(-1,-2,-3,-4,-5)
# new_data <- new_data %>%
#replace_with_na_if(.predicate = is.integer,
#                  condition = ~.x %in% (na_special))
## Limit to women
summary(categories$KEY_SEX_1997)
colnames(categories)[colnames(categories) == 'KEY_SEX_1997'] <- 'sex'
categories <- filter(categories, sex == "Female")
colnames(new_data)[colnames(new_data) == 'KEY_SEX_1997'] <- 'sex'
new_data <- filter(new_data, sex == "2")
new_data$dob <- mdy(paste(new_data$KEY_BDATE_M_1997, "1", new_data$KEY_BDATE_Y_1997, sep='-'))
### birth month
mom_month <- new_data %>%
select(PUBID_1997, starts_with("CV_CHILD_BIRTH_DATE.01~M"))
mom_month[mom_month >= -5 & mom_month <= -1] = NA  # Missing
mom_month <- mom_month %>%
gather(var, birth_month, -PUBID_1997)
mom_month <- aggregate(birth_month ~ PUBID_1997, data = mom_month, first)
### birth year
mom_year <- new_data %>%
select(PUBID_1997, starts_with("CV_CHILD_BIRTH_DATE.01~Y"))
mom_year[mom_year >= -5 & mom_year <= -1] = NA  # Missing
mom_year <- mom_year %>%
gather(var, birth_year, -PUBID_1997)
mom_year <- aggregate(birth_year ~ PUBID_1997, data = mom_year, first)
### Add new variables to original dataset
new_data   <- left_join(new_data,   mom_month)
new_data   <- left_join(new_data,   mom_year)
remove(mom_month)
remove(mom_year)
### combine child dob variables
new_data$birth <- mdy(paste(new_data$birth_month, "1", new_data$birth_year, sep='-'))
# new_data <- subset(new_data, select = -c(birth_month, birth_year))
### Create age at first birth variable
new_data$age_birth <-round((time_length(difftime(new_data$birth, new_data$dob), "years")), digits = 0)
# Marital status variables
marstat <- categories %>%
select(PUBID_1997, starts_with("CV_MARSTAT_"))
marstat[marstat >= -5 & marstat <= -1] = NA  # Missing
marstat <- marstat %>%
gather(var, marst, -PUBID_1997)
marstat <- marstat %>%
separate(var, c("type", "var", "year"), "_")
marstat <- subset(marstat, select = -c(type, var))
marstat$birth_year   <- new_data$birth_year
# Create the birth year plus 1 variables
marstat$birth_year1 <- marstat$birth_year + 1
marstat$birth_year2 <- marstat$birth_year + 2
marstat$birth_year3 <- marstat$birth_year + 3
marstat$birth_year4 <- marstat$birth_year + 4
# This loses moms who became mothers before 1997// could assume mstatus in 1997 was mstatus at time of birth
marstat <- marstat %>%
group_by(PUBID_1997) %>%
mutate(mar_t0 = case_when(birth_year  == year ~ marst),
mar_t1 = case_when(birth_year1 == year ~ marst),
mar_t2 = case_when(birth_year2 == year ~ marst),
mar_t3 = case_when(birth_year3 == year ~ marst),
mar_t4 = case_when(birth_year4 == year ~ marst))
marstat <- marstat %>% group_by(PUBID_1997) %>% summarise_all(funs(max(., na.rm = TRUE)))
marstat <- subset(marstat, select = -c(year, marst, birth_year4, birth_year3, birth_year2, birth_year1, birth_year)) # drop extra variables
marstat <- marstat %>%
mutate(
mar_t0 = case_when(
mar_t0   == "Married, spouse present"       |  mar_t0 == "Married, spouse absent"       ~ "Married",
mar_t0   == "Divorced, cohabiting"          |  mar_t0 == "Never married, cohabiting" |
mar_t0   == "Separated, cohabiting"         |  mar_t0 == "Widowed, cohabiting"          ~ "Cohab",
mar_t0   == "Never married, not cohabiting"                                             ~ "Never married",
mar_t0   == "Divorced, not cohabiting"      |  mar_t0 == "Separated, not cohabiting" |
mar_t0   == "Widowed, not cohabiting"                                                   ~ "Div/Sep/Wid",
TRUE                                                                                    ~  NA_character_
))
marstat$mar_t0 <- factor(marstat$mar_t0, levels = c("Married", "Cohab", "Never married", "Div/Sep/Wid"))
marstat <- marstat %>%
mutate(
mar_t1 = case_when(
mar_t1   == "Married, spouse present"       |  mar_t1 == "Married, spouse absent"       ~ "Married",
mar_t1   == "Divorced, cohabiting"          |  mar_t1 == "Never married, cohabiting" |
mar_t1   == "Separated, cohabiting"         |  mar_t1 == "Widowed, cohabiting"          ~ "Cohab",
mar_t1   == "Never married, not cohabiting"                                             ~ "Never married",
mar_t1   == "Divorced, not cohabiting"      |  mar_t1 == "Separated, not cohabiting" |
mar_t1   == "Widowed, not cohabiting"                                                   ~ "Div/Sep/Wid",
TRUE                                                                                    ~  NA_character_
))
marstat$mar_t1 <- factor(marstat$mar_t1, levels = c("Married", "Cohab", "Never married", "Div/Sep/Wid"))
marstat <- marstat %>%
mutate(
mar_t2 = case_when(
mar_t2   == "Married, spouse present"       |  mar_t2 == "Married, spouse absent"       ~ "Married",
mar_t2   == "Divorced, cohabiting"          |  mar_t2 == "Never married, cohabiting" |
mar_t2   == "Separated, cohabiting"         |  mar_t2 == "Widowed, cohabiting"          ~ "Cohab",
mar_t2   == "Never married, not cohabiting"                                             ~ "Never married",
mar_t2   == "Divorced, not cohabiting"      |  mar_t2 == "Separated, not cohabiting" |
mar_t2   == "Widowed, not cohabiting"                                                   ~ "Div/Sep/Wid",
TRUE                                                                                    ~  NA_character_
))
marstat$mar_t2 <- factor(marstat$mar_t2, levels = c("Married", "Cohab", "Never married", "Div/Sep/Wid"))
marstat <- marstat %>%
mutate(
mar_t3 = case_when(
mar_t3   == "Married, spouse present"       |  mar_t3 == "Married, spouse absent"       ~ "Married",
mar_t3   == "Divorced, cohabiting"          |  mar_t3 == "Never married, cohabiting" |
mar_t3   == "Separated, cohabiting"         |  mar_t3 == "Widowed, cohabiting"          ~ "Cohab",
mar_t3   == "Never married, not cohabiting"                                             ~ "Never married",
mar_t3   == "Divorced, not cohabiting"      |  mar_t3 == "Separated, not cohabiting" |
mar_t3   == "Widowed, not cohabiting"                                                   ~ "Div/Sep/Wid",
TRUE                                                                                    ~  NA_character_
))
marstat$mar_t3 <- factor(marstat$mar_t3, levels = c("Married", "Cohab", "Never married", "Div/Sep/Wid"))
marstat <- marstat %>%
mutate(
mar_t4 = case_when(
mar_t4   == "Married, spouse present"       |  mar_t4 == "Married, spouse absent"       ~ "Married",
mar_t4   == "Divorced, cohabiting"          |  mar_t4 == "Never married, cohabiting" |
mar_t4   == "Separated, cohabiting"         |  mar_t4 == "Widowed, cohabiting"          ~ "Cohab",
mar_t4   == "Never married, not cohabiting"                                             ~ "Never married",
mar_t4   == "Divorced, not cohabiting"      |  mar_t4 == "Separated, not cohabiting" |
mar_t4   == "Widowed, not cohabiting"                                                   ~ "Div/Sep/Wid",
TRUE                                                                                    ~  NA_character_
))
marstat$mar_t4 <- factor(marstat$mar_t4, levels = c("Married", "Cohab", "Never married", "Div/Sep/Wid"))
### Add new variables to original dataset
new_data   <- left_join(new_data,   marstat)
remove(marstat)
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500")) %>%
gather(var, val, -PUBID_1997) %>%
separate(var, c("type", "year"), "_")
View(mominc)
mominc <- mominc %>%
mutate(rinc  = case_when(type == "YINC-1700" ~ val),
incd  = case_when(type == "YINC-1400" ~ val),
incd2 = case_when(type == "YINC-1500" ~ val)) %>%
group_by(PUBID_1997, year) %>%
summarise(rinc = first(rinc), incd = nth(incd, 2), incd2 = last(incd2))
summary(mominc$incd2)
mominc <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(rinc = case_when( incd   == "1"    ~ rinc,
incd   == "0"    ~ 0L,
incd   == "-5"   ~ -5L,
incd   == "-4"   ~ -4L,
incd   == "-3"   ~ -3L,
incd   == "-2"   ~ -2L,
incd   == "-1"   ~ -1L,
incd2  == "0"    ~ 0L,
TRUE             ~ NA_integer_
))
summary(mominc$rinc)
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500")) %>%
gather(var, val, -PUBID_1997) %>%
separate(var, c("type", "year"), "_")
mominc <- mominc %>%
mutate(wages  = case_when(type == "YINC-1700" ~ val),
incd  = case_when(type == "YINC-1400" ~ val),
incd2 = case_when(type == "YINC-1500" ~ val)) %>%
group_by(PUBID_1997, year) %>%
summarise(wages = first(wages), incd = nth(incd, 2), incd2 = last(incd2))
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500"), starts_with("YINC-1800")) %>%
gather(var, val, -PUBID_1997) %>%
separate(var, c("type", "year"), "_")
mominc <- mominc %>%
mutate(wages     = case_when(type == "YINC-1700" ~ val),
incd      = case_when(type == "YINC-1400" ~ val),
incd2     = case_when(type == "YINC-1500" ~ val),
wages_est = case_when(type == "YINC-1800" ~ val))
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500"), starts_with("YINC-1800"))
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500"), starts_with("YINC-1800")) %>%
gather(var, val, -PUBID_1997)
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500"), starts_with("YINC-1800")) %>%
gather(var, val, -PUBID_1997) %>%
separate(var, c("type", "year"), "_")
mominc <- mominc %>%
mutate(wages     = case_when(type == "YINC-1700" ~ val),
incd      = case_when(type == "YINC-1400" ~ val),
incd2     = case_when(type == "YINC-1500" ~ val),
wages_est = case_when(type == "YINC-1800" ~ val)) %>%
group_by(PUBID_1997, year) %>%
summarise(wages = first(wages), incd = nth(incd, 2), incd2 = last(incd2), wages_est = first(wages_est))
summary(mominc$wages_est)
mominc <- mominc %>%
mutate(wages     = case_when(type == "YINC-1700" ~ val),
incd      = case_when(type == "YINC-1400" ~ val),
incd2     = case_when(type == "YINC-1500" ~ val),
wages_est = case_when(type == "YINC-1800" ~ val)) %>%
group_by(PUBID_1997, year) %>%
summarise(wages = first(wages), incd = nth(incd, 2), incd2 = last(incd2), wages_est = last(wages_est))
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500"), starts_with("YINC-1800")) %>%
gather(var, val, -PUBID_1997) %>%
separate(var, c("type", "year"), "_")
mominc <- mominc %>%
mutate(wages     = case_when(type == "YINC-1700" ~ val),
incd      = case_when(type == "YINC-1400" ~ val),
incd2     = case_when(type == "YINC-1500" ~ val),
wages_est = case_when(type == "YINC-1800" ~ val)) %>%
group_by(PUBID_1997, year) %>%
summarise(wages = first(wages), incd = nth(incd, 2), incd2 = last(incd2), wages_est = last(wages_est))
summary(mominc$wages_est)
test <- mominc %>%
filter(wages_est>= 1)
View(test)
summary(test$wages)
summary(mominc$wages)
test <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(wages = case_when(!is.na(wages)               ~ wages,
wages_est == "1" then wages ~ 2500,
wages_est == "2" then wages ~ 7500,
wages_est == "3" then wages ~ 17500,
wages_est == "4" then wages ~ 37500,
wages_est == "5" then wages ~ 75000,
wages_est == "6" then wages ~ 175000,
wages_est == "7" then wages ~ 250001,
TRUE                        ~ NA_integer_))
# https://www.nlsinfo.org/content/cohorts/nlsy97/other-documentation/codebook-supplement/appendix-5-income-and-assets-variab-3
test <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(wages = case_when(!is.na(wages)               ~ wages))
test <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(wages = case_when(!is.na(wages)    ~ wages,
wages_est == "1" ~ 2500,
wages_est == "2" ~ 7500,
wages_est == "3" ~ 17500,
wages_est == "4" ~ 37500,
wages_est == "5" ~ 75000,
wages_est == "6" ~ 175000,
wages_est == "7" ~ 250001,
TRUE             ~ NA_integer_))
class(mominc$wages_est)
class(mominc$incd)
test <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(wages = case_when(!is.na(wages)    ~ wages,
wages_est == "1" ~ 2500,
wages_est == "2" ~ 7500,
wages_est == "3" ~ 17500,
wages_est == "4" ~ 37500,
wages_est == "5" ~ 75000,
wages_est == "6" ~ 175000,
wages_est == "7" ~ 250001))
class(mominc$wages)
test <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(wages = case_when(!is.na(wages)    ~ wages,
wages_est == "1" ~ 2500L,
wages_est == "2" ~ 7500L,
wages_est == "3" ~ 17500L,
wages_est == "4" ~ 37500L,
wages_est == "5" ~ 75000L,
wages_est == "6" ~ 175000L,
wages_est == "7" ~ 250001L,
TRUE             ~ NA_integer_))
View(test)
summary(mominc$wages)
summary(test$wages)
mominc <- new_data %>%
select(PUBID_1997, starts_with("YINC-1700"), starts_with("YINC-1400"), starts_with("YINC-1500"), starts_with("YINC-1800")) %>%
gather(var, val, -PUBID_1997) %>%
separate(var, c("type", "year"), "_")
mominc <- mominc %>%
mutate(wages     = case_when(type == "YINC-1700" ~ val),
incd      = case_when(type == "YINC-1400" ~ val),
incd2     = case_when(type == "YINC-1500" ~ val),
wages_est = case_when(type == "YINC-1800" ~ val)) %>%
group_by(PUBID_1997, year) %>%
summarise(wages = first(wages), incd = nth(incd, 2), incd2 = last(incd2), wages_est = last(wages_est))
# Give people an income if they reported it, and 0 if they reported they had no income. Other is missing
#This code chunk has extra codes in it unless the missing codes were added. Doesn't mess up results to just leave it.
mominc <- mominc %>%
group_by(PUBID_1997, year) %>%
mutate(wages = case_when(incd   == "1"    ~ wages,
incd   == "0"    ~ 0L,
incd   == "-5"   ~ -5L,
incd   == "-4"   ~ -4L,
incd   == "-3"   ~ -3L,
incd   == "-2"   ~ -2L,
incd   == "-1"   ~ -1L,
incd2  == "0"    ~ 0L,
TRUE             ~ NA_integer_
))
test <- mominc %>%
filter(wages_est>= 1)
